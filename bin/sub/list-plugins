#!/usr/bin/env bash
# shellcheck disable=SC1090

set -o errexit
set -o nounset
set -o pipefail
[[ -n "${XTRACE:+x}" ]] && set -o xtrace
[[ -n "${VERBOSE:+x}" ]] && set -o verbose
[[ -n "${DEBUG:-}" ]] && IS_DEBUG=true || IS_DEBUG=false
[[ $- =~ [x] ]] && PS4='+[${BASH_SOURCE}:${LINENO}:${FUNCNAME[0]:+${FUNCNAME[0]}}()]: '

readonly SCRIPT_DIR="$(cd -P -- "$(dirname -- "$0")" && pwd -P)"

readonly opt=${1:-}

if [[ "$opt" == '-h' ]]; then
cat <<EOF
$0    : List enabled plugins
$0 -a : List all plugins
EOF
  exit
fi

# @TODO sort names
if [[ "$opt" == '-a' ]]; then
  find "$SCRIPT_DIR"/../../bash_it/plugins/available/ -type f -exec basename {} .plugin.bash \; | tr '\n' ' '
else
  # @TODO trim name prefix
  find "$SCRIPT_DIR"/../../bash_it/plugins/enabled/ -type l -exec basename {} .plugin.bash \; | tr '\n' ' '
fi

echo ""
